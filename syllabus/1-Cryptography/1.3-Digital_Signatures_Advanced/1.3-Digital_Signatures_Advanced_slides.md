---
title: Advanced Digital Signatures
description: More exotic digital signature methods
duration: 1 hour
instructors: ["Gavin Wood"]
teaching-assistants: ["Dan Shields"]
---

# Digital Signatures: Advanced

---

### Certificates

Certificates let one key owner attest to a claim about another. This implies some trust in an attester. Traditionally provided under "Certificate Authority" or "Web of Trust" schemes.

---

### Certificates in Web3

We are building systems that don't have a "Certificate Authority". But we can still use certificates for many applications.

---

### Session Keys

<!--still haven't gotten to substrate, so keeping this high level for now-->

Session keys are a set of keys that generally run in online infrastructure. An account, whose keys are protected, can sign a transaction to certify all the keys in the set.

Session keys are used to sign operational messages, but also in challenge-response type games to prove availability by signing a message.

---

### On-Chain Certificates

Sometimes we want to allow other accounts to act on our behalf for certain operations.

We can sign messages (in this case, transactions) that include the authorised account and its permissions.

A digital "power of attorney".

---

## Multi-Signatures

---

### Multi-Signatures

We often want signatures that must be signed by multiple parties to become valid.

- Require some threshold of members to agree to a message
- Protect against key loss

---

### Types of Multi-Signature

- Verifier enforced
- Cryptographic

Cryptographic multi-signature schemes further have two types: threshold and non-threshold. We focus on threshold multi-signatures.

---

### Verifier Enforced Multi-Sigs

We assume that there is some verifier, who can check that some threshold of individual keys have provided valid signatures.

This could be a trusted company or third party. But for our purposes it's a shared state machine.

---

### Verifier Enforced Multi-Sigs

Verifier enforced multi-sigs generally provide a good user experience, as no interaction is required from the participants.

This good experience comes at the cost of using state and paying for many individual transactions, but is generally low.

---

### Code Demo

<!--
	Just an idea, but perhaps a quick peak into the Multisig pallet to see some storage items?
	Maybe too early to get into transactions, but will show that a verifier can store the _hash_
	of a call authorisation and required threshold of signers to authorise.
-->
```rust
pub type Multisigs<T: Config> = StorageDoubleMap<
	_,
	// Hasher used for the first part of the database key
	Twox64Concat,
	// AccountId requiring a threshold multisignature
	T::AccountId,
	// Hasher used for the second part of the database key
	Blake2_128Concat,
	// Hash (32 bytes) of the message to authorise
	[u8; 32],
	// Information about the approvals so far (which accounts have already authorised)
	Multisig<T::BlockNumber, BalanceOf<T>, T::AccountId>,
>;
```

---

### Cryptographic Multi-Sigs

Cryptographic multi-signatures can be generated entirely outside of the verifier. But they do introduce more work for the participants.

---

### Key Generation

All signers run a distributed key generation (DKG) protocol that constructs key _shares_.

The secret encodes the threshold behavior, and signing demands some threshold of signature _fragments_.

This DKG protocol breaks other useful things, like hard key derivation.

---

### Schnorr Multi-Sigs

Schnorr signatures improve operational security without altering or complicating verifier logic.

- Reduce verifier costs in bandwidth & CPU time, so great for certificates.
- Support soft key defivations.
- Automation becomes tricky: We need agreement upon the final signer list, and two random nonce contrbutions from each prospective signer, before constructing the signature fragments.

---

### BLS Signatures

Allows multiple signatures generated under multiple public keys for multiple messages to be aggregated into a single signature.

- Uses heavier pairing friendly elliptic curves than ECDSA/Schnorr.
- Automates easier: Aggregation without advance agreement upon the signer list.
- Very popular for concensus.

(Coming to Substrate soon.)

---

### BLS Signatures

However...

- DKGs remain tricky.
- Soft key derivations are typically insecure for BLS.
- Verifiers are hundreds of times slower than Schnorr, due to using pairings, so they typically only appear in exotic situations, e.g. light clients.

---

### Schnorr and BLS Summary

Schnorr & BLS multi-signatures avoid complicating verifier logic, but both bring user experience costs like DKG protocols, reduced key derivation ability, and verification speed.

---

### Ring Signatures

- Ring signatures prove the signer lies within some "anonymity set" of signing keys, but hide which key actually signed.
- Ring signatures come in many sizes, with many ways of presenting their anonymity sets.
- Anonymous blockchain transactions typically employ ring signatures.


---

### Ring Signature Applications

- ZCash uses a ring signature based upon Groth16 zkSNARKs which makes the entire chain history be the anonymity set.
- Anonymous credentials provide a data structure in which verifiers can check issuer certificates without the user revealing the entire contents of the signed message. For example, to prove you have a driver's license without revealing the information on it.

---
