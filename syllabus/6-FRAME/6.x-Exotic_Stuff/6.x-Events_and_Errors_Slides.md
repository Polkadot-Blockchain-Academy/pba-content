# Events and Errors

---

## Events and Errors

In this presentation, we will go over two of the tools you have access to when developing FRAME Pallets to express how your runtime calls are executing.

---

## Errors

Not all extrinsics are valid. It could be for a number of reasons:

* The extrinsic itself is badly formatted. (wrong parameters, encoding, etc...)
* The call does

---

## Dispatch Result

All pallet calls return at the end a `DispatchResult`.

From: `substrate/frame/support/src/dispatch.rs`

```rust
pub type DispatchResult = Result<(), sp_runtime::DispatchError>;
```

So a function can either return `Ok(())` or some `DispatchError`.

---

## Dispatch Error

From: `substrate/primitives/runtime/src/lib.rs`

```rust [0|6-10|13-14|15-16]
/// Reason why a dispatch call failed.
#[derive(Eq, Clone, Copy, Encode, Decode, Debug, TypeInfo, PartialEq)]
#[cfg_attr(feature = "std", derive(Serialize, Deserialize))]
pub enum DispatchError {
	/// Some error occurred.
	Other(
		#[codec(skip)]
		#[cfg_attr(feature = "std", serde(skip_deserializing))]
		&'static str,
	),
	/// Failed to lookup some data.
	CannotLookup,
	/// A bad origin.
	BadOrigin,
	/// A custom error in a module.
	Module(ModuleError),
	/// At least one consumer is remaining so the account cannot be destroyed.
	ConsumerRemaining,
	/// There are no providers so the account cannot be created.
	NoProviders,
	/// There are too many consumers so the account cannot be created.
	TooManyConsumers,
	/// An error to do with tokens.
	Token(TokenError),
	/// An arithmetic error.
	Arithmetic(ArithmeticError),
	/// The number of transactional layers has been reached, or we are not in a transactional
	/// layer.
	Transactional(TransactionalError),
}
```

---

## Module Errors

From: `substrate/primitives/runtime/src/lib.rs`

```rust
/// The number of bytes of the module-specific `error` field defined in [`ModuleError`].
/// In FRAME, this is the maximum encoded size of a pallet error type.
pub const MAX_MODULE_ERROR_ENCODED_SIZE: usize = 4;

/// Reason why a pallet call failed.
#[derive(Eq, Clone, Copy, Encode, Decode, Debug, TypeInfo)]
#[cfg_attr(feature = "std", derive(Serialize, Deserialize))]
pub struct ModuleError {
	/// Module index, matching the metadata module index.
	pub index: u8,
	/// Module specific error value.
	pub error: [u8; MAX_MODULE_ERROR_ENCODED_SIZE],
	/// Optional error message.
	#[codec(skip)]
	#[cfg_attr(feature = "std", serde(skip_deserializing))]
	pub message: Option<&'static str>,
}
```

So an error is at most just 5 bytes.

---

## Declaring Errors



```rust
// Errors inform users that something went wrong.
#[pallet::error]
pub enum Error<T> {
	/// The user gave us a bad input.
	BadInput,
	/// Errors should have helpful documentation associated with them.
	StorageOverflow,
}
```
