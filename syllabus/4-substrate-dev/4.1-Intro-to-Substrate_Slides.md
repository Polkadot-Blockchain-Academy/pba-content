---
title: Introduction to Substrate
description: Substrate Overview for Web3 engineers
duration: 45 minutes
instructors: ["Kian Paimani"]
teaching-assistants: ["..."]
---

# Introduction to Substrate

<widget-speaker name="Kian Paimani" position="Core Dev" image="../../../assets/img/0-Shared/people/kian.png" github="kianenigma" twitter="kianenigma"></widget-speaker>

---

## What is Substrate?

Substrate is a **Rust framework** for **building blockchains** in a modular and extensible way.

---v

### Why Substrate?

<div>
Future is multi-chain.

..
</div>

<div>
Building a blockchain is hard.

..
</div>

<!-- .element: class="fragment" -->

The need for a framework to build *customizable*, *unstoppable* blockchains is crucial for this future.

<!-- .element: class="fragment" -->

> In general you shouldn't try to build a blockchain yourself from scratch. You will probably get it
> wrong.

<!-- .element: class="fragment" -->

---v

### Core Philosophies of Substrate

The **non-substrate** way of thinking:

* Writing blockchains is hard.
* Upgrading blockchains is hard.
* We are going to spend maximal resources at making sure we get it right the first time.

---v

### Core Philosophies of Substrate

The **substrate** way of thinking:

It all starts with a deep acknowledgment that **humans are fallible**.

> It is only a matter of time until the "right choice" of today turns into a mistake in the future.

Unless, if you don't fixate things too much, and focus more on building APIs üß†.


---v

### Core Philosophies of Substrate

Outcomes of this:

* Rust as a language
* Upgradeability through a WASM meta-protocol.
* Generic. APIs >> Opinions.

---v

### Core Philosophies of Substrate: Rust as a language

Memory safety is a fundamental issue in most major system-level programming languages.

* üò≠ `segfault`
* üòá You **cannot** make certain mistakes in Rust.
* üèéÔ∏è Most Rust abstractions are zero-cost. Rust has no "runtime". It as fast as a binary can be.


---v

### Core Philosophies of Substrate: Upgradeability

* üí™üèª Substrate is HIGHLY upgradable. We'll learn about it soon.

---v

### Core Philosophies of Substrate: Generic

* Multiple consensus engines (BABE/Grandpa/AURA)
* Multiple network protocols (QUIC, TCP..)
* Multiple database implementations (ParityDB, RocksDB)
* Multiple ledger-state formats (UTXO, Account-based)

---v

### Core Philosophies of Substrate: Generic

* **AlephZero**: Custom consensus, DAG-based, 1s block time.
* **Moonbeam**: Ethereum compatible, build with substrate
* **HydraDX**: Custom transaction pool logic to match DEX orders.

---

## Substrate Architecture

At a very high level, a Substrate node has two parts:

1. A WASM runtime: Business logic as WASM.
2. The Client - A WASM executor.

> Client ~ Host ~ Node

---v

### Substrate Architecture

<img src="../../../assets/img/4-Substrate/dev-4-1-substrate.svg"></img>

---

## The Runtime

The runtime contains all of the **business logic** of your chain.

...

In a more *fancy* term, the runtime is the **state transition function**.

...

In a more *technical* term, the definition of **how your blockchain executes blocks**.

NOTE:

TODO: check how much has so far been told about STF. If not, delve deep into it. A basic automata.

---v

### State Transition

**State:** The entire set of data that we want to come to consensus about.

<img style="width: 1200px;" src="../../../assets/img/4-Substrate/dev-4-1-state.svg"></img>

---v

### State Transition

**Transition:** The runtime, the piece of logic that dictates how the state changes.

<img style="width: 1200px;" src="../../../assets/img/4-Substrate/dev-4-1-transition.svg"></img>

---v

### STF is Turing-Complete

> A programming language is called ‚ÄúTuring complete‚Äù if it can run any program that a Turing Machine can run given enough time and memory

The runtime, except for context dependent resource limitations, is turing-complete.

---v

### Consequences of *WASM* Runtime

* ü§ñ deterministic execution
* üß± sandboxing (more relevant in Polkadot)
* üòé forkless upgrade!*


> *Arguably the biggest design choice of the whole substrate ecosystem.

---v

### ü§ñ Deterministic Execution

* The need for determinism in a blockchain runtime is *absolute*.

---v

### üß± Sandboxing

* Substrate uses the same WASM machinery for executing:

1. smart contracts
2. Parachain Runtime (i.e. PVF)

---v

### üòé Forkless Upgrade:


<img style="width: 1200px;" src="../../../assets/img/4-Substrate/dev-4-1-forkless-1.svg" />

---v

### üòé Forkless Upgrade:

<img style="width: 1200px;" src="../../../assets/img/4-Substrate/dev-4-1-forkless-2.svg" />

---v

### What is WASM Anyways?

<img style="width: 1200px;" src="../../../assets/img/4-Substrate/dev-4-1-wasm-langs.svg">

---v

### What is WASM Anyways?

WAS is deeply suitable for the web-browser scenario:

* Streaming and rapid compilation (compilation as delivery is happening).
* Designed with the concept of host in mind. Sandboxed, permissioned sys-calls.
* Secure foreign code execution.

> People actually tried sticking things like JVM into the browser (*Java Applets*), but it didn't work.

---v

### What is WASM Anyways?

But it turns out, the requirements of Substrate and a browser is quite similar!

* Determinism, sandboxed, upgradable.

<img style="width: 1200px;" src="../../../assets/img/4-Substrate/dev-4-1-wasm.svg">

---v

### SMOLDOT

A true marvel of universe.

* (light) Substrate node compiled to WASM, by the browser.
* Itself executing another WASM blob, the aforementioned runtime.

<img style="width: 1200px;" src="../../../assets/img/4-Substrate/dev-4-1-smoldot.svg">

---v

### How to Write a WASM Runtime?

* Any language that can compile to WASM and exposes a fixed set of functions, to be used by the
client.
* ... But, of course, Substrate comes with its own variant of this, **FRAME‚Ñ¢Ô∏è**.

---

## The Client

Everything else you need in a blockchain, except the consensus-critical, deterministic runtime we
just spoke of.

---v

### The Client

<img style="width: 1200px;" src="../../../assets/img/4-Substrate/dev-4-3-full.svg">


---v

### The Client: Consensus ü§î

* Yes, consensus is not a core part of a blockchain runtime. It is not application logic. It is not something you want to customize.

* The consensus protocol is to your runtime what HTTP is to Facebook.

---v

### The Client

- Compiled to native.
- Less need for determinism.
- Has access to anything a normal native binary does (memory, disk, syscalls etc.)

---

### Substrate: The Gaming Console of Blockchains!

<div class="flex-container">
<div class="left">

<img src="../../../assets/img/4-Substrate/nintendo-console-2.png" style="width:400px;"/>

Substrate Client

</div>
<div class="right">

<img src="../../../assets/img/4-Substrate/nintendo-game.png" style="width:400px;"/>

Substrate Runtime

</div>
</div>

NOTE:

https://www.cleanpng.com/png-game-boy-advance-deviantart-video-game-consoles-2183359/


---

### Substrate: VHDL and FPGA analogy.


---

## Communication Paths

<img style="width: 1400px" src="../../../assets/img/4-Substrate/dev-4-1-comms.svg">

---v

### Example: SCALE vs JSON

<div class="flex-container">
<div class="left">

```rust
use parity_scale_codec::{ Encode };

#[derive(Encode)]
struct Example {
	number: u8,
	is_cool: bool,
	optional: Option<u32>,
}

fn main() {
	let my_struct = Example {
		number: 42,
		is_cool: true,
		optional: Some(69),
	};
	println!("{:?}", my_struct.encode());
	println!("{:?}", my_struct.encode().len());
}
```

```bash
[42, 1, 1, 69, 0, 0, 0]
7
```

</div>
<div class="right" style="margin-left: 10px;">

```rust
use serde::{ Serialize };

#[derive(Serialize)]
struct Example {
	number: u8,
	is_cool: bool,
	optional: Option<u32>,
}

fn main() {
	let my_struct = Example {
		number: 42,
		is_cool: true,
		optional: Some(69),
	};
	println!("{:?}", serde_json::to_string(&my_struct).unwrap());
	println!("{:?}", serde_json::to_string(&my_struct).unwrap().len());
}
```

```bash
"{\"number\":42,\"is_cool\":true,\"optional\":69}"
42
```

</div>

---

## Technical Freedom vs Ease

<img style="width: 1000px;" src="../../../assets/img/4-Substrate/freedom-ease.svg"/>
