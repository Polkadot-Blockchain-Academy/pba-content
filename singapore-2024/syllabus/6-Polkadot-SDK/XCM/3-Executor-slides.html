<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <title>XCM Executor</title>
  <link rel="icon" href="./../../../assets/favicon.svg" />
  <link rel="shortcut icon" href="./../../../assets/favicon.png" />
  <link rel="stylesheet" href="./../../../dist/reset.css" />
  <link rel="stylesheet" href="./../../../dist/reveal.css" />
  <link rel="stylesheet" href="./../../.././assets/styles/PBA-theme.css" id="theme" />
  <link rel="stylesheet" href="./../../../css/highlight/shades-of-purple.css" />

  <link rel="stylesheet" href="./../../.././assets/styles/custom-classes.css" />

</head>

<body class="site">
  <header class="site-header">
    <!-- This logo is a link only on the watching server, not the production build -->
    <a href="">
      <img style="height: 2.5vw;" class="watermark-logo" src="./../../../assets/img/0-Shared/logo/pba-logo-white.svg"
        alt="PBA Logo">
    </a>
  </header>
  <main class="reveal">
    <article class="slides">
      <section ><section data-markdown><script type="text/template">

# XCM Executor
</script></section><section data-markdown><script type="text/template">
## What you'll learn

<pba-flex center>

- The XCVM
- XCM Executor
</script></section></section><section ><section data-markdown><script type="text/template">
# The XCVM

At the core of XCM lies the **Cross-Consensus Virtual Machine (XCVM)**.

The XCVM is a state machine, state is kept track in **registers**.

How the virtual machine should act is written in the XCM [specification](https://github.com/paritytech/xcm-format).

<aside class="notes"><p>Itâ€™s an ultra-high level non-Turing-complete computer.
Messages are one or more XCM instructions.
The program executes until it either runs to the end or hits an error, at which point it finishes up and halts.</p>
</aside></script></section><section data-markdown><script type="text/template">
## XCVM Registers

<pba-flex center>

- Holding
- Origin
- ErrorHandler
- Appendix
- ...

<aside class="notes"><p>Registers are the state of the XCVM.
They are transient, temporary.</p>
</aside></script></section><section data-markdown><script type="text/template">
## The Origin Register

Contains an `Option<Location>` of the cross-consensus origin where the message originated from.

<aside class="notes"><p>This <code>Location</code> can change over the course of program execution.</p>
<p>It might be <code>None</code> because some instructions clear the origin register.</p>
</aside></script></section><section data-markdown><script type="text/template">
## The Holding Register

Expresses a number of assets in control of the xcm execution that have no on-chain representation.

They don't belong to any account.

It can be seen as the register holding "unspent assets".

<aside class="notes"><p>Some instructions, like <code>WithdrawAsset</code>, put funds in the holding register.
Other instructions, like <code>DepositAsset</code>, take funds out of the holding register.</p>
</aside></script></section><section data-markdown><script type="text/template">
## Instructions

Instructions might change a register, the state of the consensus system, or both.
</script></section></section><section ><section data-markdown><script type="text/template">
# XCVM Operation
</script></section><section data-markdown><script type="text/template">
## Fetch/execute loop

The XCVM operates in a typical fetch/execute loop.

Each instruction is fetched and executed in order.
</script></section><section data-markdown><script type="text/template">
## Error handler and appendix

Two interesting additions by the XCVM are the error handler and appendix.

They contain more instructions that are executed if there's an error or unconditionally
at the end of execution, accordingly.
</script></section></section><section ><section data-markdown><script type="text/template">
# XCM Executor

Parity provides an implementation of the XCVM spec, the `XcmExecutor`.

It's the entrypoint for executing XCMs.
</script></section><section data-markdown><script type="text/template">
<pba-flex center>

```rust
XcmExecutor::prepare_and_execute(
  origin,
  xcm,
  &mut hash,
  weight_limit,
  weight_credit,
);
```
</script></section><section data-markdown><script type="text/template">
## Configuration

The `XcmExecutor` is highly configurable, so it can be implemented by many different chains
just adjusting some configuration items.

These items provide the executor access to the chain's runtime.

This is, for example, how different chains can route different asset instructions to different
pallets (pallet-balances vs pallet-assets).

<aside class="notes"><p>The executor&#39;s state is transient, so any state changes to the underlying system need to happen in these configuration items.</p>
</aside></script></section></section><section  data-markdown><script type="text/template">
# Summary

<pba-flex center>

- XCVM
- XCM Executor
</script></section><section  data-markdown><script type="text/template">
# Workshop

We'll create our own very simple implementation of the XCVM.
</script></section><section  data-markdown><script type="text/template">
# Next steps

How does the XCM subsystem interact with FRAME.
</script></section>
    </article>
  </main>

  <script src="./../../../dist/reveal.js"></script>

  <script src="./../../../plugin/markdown/markdown.js"></script>
  <script src="./../../../plugin/highlight/highlight.js"></script>
  <script src="./../../../plugin/zoom/zoom.js"></script>
  <script src="./../../../plugin/notes/notes.js"></script>
  <script src="./../../../plugin/math/math.js"></script>

  <script src="./../../../assets/plugin/mermaid.js"></script>
  <script src="./../../../assets/plugin/mermaid-theme.js"></script>

  <script src="./../../../assets/plugin/chart/chart.js"></script>
  <script src="./../../../assets/plugin/chart/chart.min.js"></script>

  <script src="./../../../assets/plugin/tailwindcss.min.js"></script>

  <script>
    function extend() {
      var target = {};
      for (var i = 0; i < arguments.length; i++) {
        var source = arguments[i];
        for (var key in source) {
          if (source.hasOwnProperty(key)) {
            target[key] = source[key];
          }
        }
      }
      return target;
    }

    // default options to init reveal.js
    var defaultOptions = {
      controls: true,
      progress: true,
      history: true,
      center: true,
      transition: 'default', // none/fade/slide/convex/concave/zoom
      slideNumber: true,
      mermaid: {
        startOnLoad: false,
        logLevel: 3,
        theme: 'base',
        themeVariables: {
          primaryColor: purple,
          primaryTextColor: white,
          primaryBorderColor: pink,
          lineColor: pink,
          secondaryColor: lightPurple,
          tertiaryColor: lightPurple,
        },
      },
      chart: {
        defaults: {
          color: 'lightgray', // color of labels
          scale: {
            beginAtZero: true,
            ticks: { stepSize: 1 },
            grid: { color: "lightgray" }, // color of grid lines
          },
        },
        line: { borderColor: ["#ccc", "#E6007A", "#6D3AEE"], "borderDash": [[5, 10], [0, 0]] },
        bar: { backgroundColor: ["#ccc", "#E6007A", "#6D3AEE"] },
      },
      plugins: [
        RevealMarkdown,
        RevealHighlight,
        RevealZoom,
        RevealNotes,
        RevealMath,
        RevealMermaid,
        RevealChart
      ]
    };

    // options from URL query string
    var queryOptions = Reveal().getQueryHash() || {};

    var options = extend(defaultOptions, {"width":1400,"height":900,"margin":0,"minScale":0.2,"maxScale":2,"transition":"none","controls":true,"progress":true,"center":true,"slideNumber":true,"backgroundTransition":"fade"}, queryOptions);
  </script>


  <script>
    Reveal.initialize(options);
  </script>
</body>

</html>
